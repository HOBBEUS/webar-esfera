<!DOCTYPE html>
<html>
  <head>
    <title>Esfera RA con marcador personalizado</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style> body { margin: 0; overflow: hidden; } </style>
  </head>
  <body>
    <a-scene embedded arjs>
      <!-- Marcador personalizado -->
      <a-marker id="mi-marcador" type="pattern" url="mipattern.patt">
        <a-sphere id="esfera" position="0 0.5 0" radius="0.3" color="red"></a-sphere>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      AFRAME.registerComponent('movimiento-dinamico', {
        init: function () {
          this.lastPosition = new THREE.Vector3();
          this.tempPosition = new THREE.Vector3();
          this.esfera = document.querySelector('#esfera');
        },
        tick: function () {
          const marcador = document.querySelector('#mi-marcador').object3D;

          if (!marcador.visible) return;

          marcador.getWorldPosition(this.tempPosition);

          const delta = this.tempPosition.clone().sub(this.lastPosition);
          const intensidad = 5;
          const nuevaPos = new THREE.Vector3(
            delta.x * intensidad,
            0.5 + delta.y * intensidad,
            delta.z * intensidad
          );

          this.esfera.object3D.position.lerp(nuevaPos, 0.1);
          this.lastPosition.copy(this.tempPosition);
        }
      });

      document.querySelector('a-scene').setAttribute('movimiento-dinamico', '');
    </script>
  </body>
</html>

